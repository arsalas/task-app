import{u as V,r as $,j as N,_ as A,c as X,o as y,e as O,f as d,t as P,h as c,n as H,H as R,G as W,m as G,D as j,F as Y,p as J,i as Z}from"./file_index.285f0698.js";import{u as K,a as w,d as Q}from"./file_Tasks.20b810c0.js";import{u as ee,a as te}from"./file_useNotification.c03c1645.js";import{_ as ie}from"./file__plugin-vue_export-helper.e718e6fb.js";import"./file_useAuth.9b3c5c44.js";function b(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function D(e,i){for(var t=0;t<i.length;t++){var s=i[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function F(e,i,t){return i&&D(e.prototype,i),t&&D(e,t),e}function x(e){return+e.replace(/px/,"")}function se(e){var i=window.devicePixelRatio,t=getComputedStyle(e),s=x(t.getPropertyValue("width")),a=x(t.getPropertyValue("height"));e.setAttribute("width",(s*i).toString()),e.setAttribute("height",(a*i).toString())}function v(e,i){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=Math.random()*(i-e)+e;return Math.floor(s*Math.pow(10,t))/Math.pow(10,t)}function L(e){return e[v(0,e.length)]}var ae=.00125,oe=5e-4,ne=9e-4,re=1e-5,ce=6,le=80,de=.9,ue=1.7,fe=.2,he=.6,me=.03,ve=.07,B=15,z=82,pe=150,_e=100,Ce=250,ge=40,Ie=["#fcf403","#62fc03","#f4fc03","#03e7fc","#03fca5","#a503fc","#fc03ad","#fc03c2"];function q(e){var i=1920;return Math.log(e)/Math.log(i)}var U=function(){function e(i){b(this,e);var t=i.initialPosition,s=i.direction,a=i.confettiRadius,n=i.confettiColors,o=i.emojis,u=i.emojiSize,l=i.canvasWidth,h=v(de,ue,3),r=h*q(l);this.confettiSpeed={x:r,y:r},this.finalConfettiSpeedX=v(fe,he,3),this.rotationSpeed=o.length?.01:v(me,ve,3)*q(l),this.dragForceCoefficient=v(oe,ne,6),this.radius={x:a,y:a},this.initialRadius=a,this.rotationAngle=s==="left"?v(0,.2,3):v(-.2,0,3),this.emojiSize=u,this.emojiRotationAngle=v(0,2*Math.PI),this.radiusYUpdateDirection="down";var m=s==="left"?v(z,B)*Math.PI/180:v(-B,-z)*Math.PI/180;this.absCos=Math.abs(Math.cos(m)),this.absSin=Math.abs(Math.sin(m));var p=v(-pe,0),_={x:t.x+(s==="left"?-p:p)*this.absCos,y:t.y-p*this.absSin};this.currentPosition=Object.assign({},_),this.initialPosition=Object.assign({},_),this.color=o.length?null:L(n),this.emoji=o.length?L(o):null,this.createdAt=new Date().getTime(),this.direction=s}return F(e,[{key:"draw",value:function(t){var s=this.currentPosition,a=this.radius,n=this.color,o=this.emoji,u=this.rotationAngle,l=this.emojiRotationAngle,h=this.emojiSize,r=window.devicePixelRatio;n?(t.fillStyle=n,t.beginPath(),t.ellipse(s.x*r,s.y*r,a.x*r,a.y*r,u,0,2*Math.PI),t.fill()):o&&(t.font="".concat(h,"px serif"),t.save(),t.translate(r*s.x,r*s.y),t.rotate(l),t.textAlign="center",t.fillText(o,0,0),t.restore())}},{key:"updatePosition",value:function(t,s){var a=this.confettiSpeed,n=this.dragForceCoefficient,o=this.finalConfettiSpeedX,u=this.radiusYUpdateDirection,l=this.rotationSpeed,h=this.createdAt,r=this.direction,m=s-h;if(a.x>o&&(this.confettiSpeed.x-=n*t),this.currentPosition.x+=a.x*(r==="left"?-this.absCos:this.absCos)*t,this.currentPosition.y=this.initialPosition.y-a.y*this.absSin*m+ae*Math.pow(m,2)/2,this.rotationSpeed-=this.emoji?1e-4:re*t,this.rotationSpeed<0&&(this.rotationSpeed=0),this.emoji){this.emojiRotationAngle+=this.rotationSpeed*t%(2*Math.PI);return}u==="down"?(this.radius.y-=t*l,this.radius.y<=0&&(this.radius.y=0,this.radiusYUpdateDirection="up")):(this.radius.y+=t*l,this.radius.y>=this.initialRadius&&(this.radius.y=this.initialRadius,this.radiusYUpdateDirection="down"))}},{key:"getIsVisibleOnCanvas",value:function(t){return this.currentPosition.y<t+_e}}]),e}();function Se(){var e=document.createElement("canvas");return e.style.position="fixed",e.style.width="100%",e.style.height="100%",e.style.top="0",e.style.left="0",e.style.zIndex="1000",e.style.pointerEvents="none",document.body.appendChild(e),e}function Te(e){var i=e.confettiRadius,t=i===void 0?ce:i,s=e.confettiNumber,a=s===void 0?e.confettiesNumber||(e.emojis?ge:Ce):s,n=e.confettiColors,o=n===void 0?Ie:n,u=e.emojis,l=u===void 0?e.emojies||[]:u,h=e.emojiSize,r=h===void 0?le:h;return e.emojies&&console.error("emojies argument is deprecated, please use emojis instead"),e.confettiesNumber&&console.error("confettiesNumber argument is deprecated, please use confettiNumber instead"),{confettiRadius:t,confettiNumber:a,confettiColors:o,emojis:l,emojiSize:r}}var ye=function(){function e(i){var t=this;b(this,e),this.canvasContext=i,this.shapes=[],this.promise=new Promise(function(s){return t.resolvePromise=s})}return F(e,[{key:"getBatchCompletePromise",value:function(){return this.promise}},{key:"addShapes",value:function(){var t;(t=this.shapes).push.apply(t,arguments)}},{key:"complete",value:function(){var t;return this.shapes.length?!1:((t=this.resolvePromise)===null||t===void 0||t.call(this),!0)}},{key:"processShapes",value:function(t,s,a){var n=this,o=t.timeDelta,u=t.currentTime;this.shapes=this.shapes.filter(function(l){return l.updatePosition(o,u),l.draw(n.canvasContext),a?l.getIsVisibleOnCanvas(s):!0})}}]),e}(),Ee=function(){function e(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};b(this,e),this.activeConfettiBatches=[],this.canvas=i.canvas||Se(),this.canvasContext=this.canvas.getContext("2d"),this.requestAnimationFrameRequested=!1,this.lastUpdated=new Date().getTime(),this.iterationIndex=0,this.loop=this.loop.bind(this),requestAnimationFrame(this.loop)}return F(e,[{key:"loop",value:function(){this.requestAnimationFrameRequested=!1,se(this.canvas);var t=new Date().getTime(),s=t-this.lastUpdated,a=this.canvas.offsetHeight,n=this.iterationIndex%10===0;this.activeConfettiBatches=this.activeConfettiBatches.filter(function(o){return o.processShapes({timeDelta:s,currentTime:t},a,n),n?!o.complete():!0}),this.iterationIndex++,this.queueAnimationFrameIfNeeded(t)}},{key:"queueAnimationFrameIfNeeded",value:function(t){this.requestAnimationFrameRequested||this.activeConfettiBatches.length<1||(this.requestAnimationFrameRequested=!0,this.lastUpdated=t||new Date().getTime(),requestAnimationFrame(this.loop))}},{key:"addConfetti",value:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=Te(t),a=s.confettiRadius,n=s.confettiNumber,o=s.confettiColors,u=s.emojis,l=s.emojiSize,h=this.canvas.getBoundingClientRect(),r=h.width,m=h.height,p=m*5/7,_={x:0,y:p},I={x:r,y:p},S=new ye(this.canvasContext),T=0;T<n/2;T++){var k=new U({initialPosition:_,direction:"right",confettiRadius:a,confettiColors:o,confettiNumber:n,emojis:u,emojiSize:l,canvasWidth:r}),f=new U({initialPosition:I,direction:"left",confettiRadius:a,confettiColors:o,confettiNumber:n,emojis:u,emojiSize:l,canvasWidth:r});S.addShapes(k,f)}return this.activeConfettiBatches.push(S),this.queueAnimationFrameIfNeeded(),S.getBatchCompletePromise()}},{key:"clearCanvas",value:function(){this.activeConfettiBatches=[]}}]),e}();const ke=()=>{const e=new Ee,{isModalOpen:i,toggleModal:t}=ee(),{closeConfirm:s,confirm:a,setConfirm:n}=Ne(),{notification:o,failNotification:u,successNotification:l}=te(),{completed:h,totalTasks:r}=K(),m=V(),p=()=>{n("Borrar tarea","Estas seguro que quieres eliminar la tarea?")},_=()=>{s()},I=g=>{s(),C(g)},S=()=>{t(),l("Task modificada")},T=()=>{t(),u("No se ha podido guardar la tarea")},k=async g=>{if(!await w(g,{is_completed:!0}))return!1;m.completeTask(g),h.value===r.value&&e.addConfetti()},f=async g=>{await w(g,{is_completed:!1})&&m.incompleteTask(g)},C=async g=>{await Q(g)&&m.deleteTask(g)};return{isModalOpen:i,notification:o,confirm:a,deleteTaskConfirm:p,cancelDelete:_,confirmDelete:I,successEdit:S,failEdit:T,completedTask:k,incompletedTask:f,removeTask:C}},Ne=()=>{const e=$({isOpen:!1,title:"",message:""});return{confirm:e,setConfirm:(s,a)=>{e.value.isOpen=!0,e.value.title=s,e.value.message=a},closeConfirm:()=>{e.value.isOpen=!1}}},Ae=e=>{const i=Math.floor(e/1e3),t=Math.floor(i/60),s=Math.floor(t/60),a=Math.floor(s/24);return{seconds:i,minutes:t,hours:s,days:a}},Oe=e=>{let i=Math.floor(new Date(e)-new Date);i>0&&(i=0);const{seconds:t,minutes:s,hours:a,days:n}=Ae(i),o=new Intl.RelativeTimeFormat("es-ES",{numeric:"auto"});return t>-60?o.format(t,"seconds"):s>-60?o.format(s,"minutes"):a>-24?o.format(a,"hours"):o.format(n,"days")};const E=e=>(J("data-v-614a3f6b"),e=e(),Z(),e),Pe={class:"card-header"},Re={class:"card-header-title truncate"},je={class:"card-content"},be={class:"content"},Fe={class:"icon-text mt-4 is-size-6 has-text-grey-light"},Me=E(()=>d("span",{class:"icon"},[d("i",{class:"fa-regular fa-clock"})],-1)),we={class:"card-footer"},De={class:"card-footer-item"},xe=E(()=>d("i",{class:"fa-solid fa-circle-check"},null,-1)),Le=[xe],Be=E(()=>d("i",{class:"fa-regular fa-circle-check"},null,-1)),ze=[Be],qe={class:"card-footer-item"},Ue=E(()=>d("i",{class:"fa-solid fa-pen-to-square"},null,-1)),Ve=[Ue],$e={class:"card-footer-item"},Xe=E(()=>d("i",{class:"fa-solid fa-trash"},null,-1)),He=[Xe],We={__name:"TaskCard",props:{task:Object},setup(e){const i=e,t=N(()=>A(()=>import("./file_Modal.d40f61e9.js"),["assets/file_Modal.d40f61e9.js","assets/file_index.285f0698.js","assets/file_index.a189d404.css"])),s=N(()=>A(()=>import("./file_Notification.cbcf9b34.js"),["assets/file_Notification.cbcf9b34.js","assets/file_Notification.98596f22.css","assets/file__plugin-vue_export-helper.e718e6fb.js","assets/file_index.285f0698.js","assets/file_index.a189d404.css"])),a=N(()=>A(()=>import("./file_UpdateTask.a2c64586.js"),["assets/file_UpdateTask.a2c64586.js","assets/file_UpdateTask.712dc8e7.css","assets/file_index.285f0698.js","assets/file_index.a189d404.css","assets/file_useFormTask.ae3ed45d.js","assets/file_Tasks.20b810c0.js","assets/file_Tasks.b2c2db7a.css","assets/file__plugin-vue_export-helper.e718e6fb.js","assets/file_useAuth.9b3c5c44.js","assets/file_useNotification.c03c1645.js"])),n=N(()=>A(()=>import("./file_Confirm.d22adf54.js"),["assets/file_Confirm.d22adf54.js","assets/file_Confirm.ac2bb9d0.css","assets/file_index.285f0698.js","assets/file_index.a189d404.css","assets/file__plugin-vue_export-helper.e718e6fb.js"])),{cancelDelete:o,confirm:u,confirmDelete:l,completedTask:h,incompletedTask:r,deleteTaskConfirm:m,failEdit:p,isModalOpen:_,notification:I,successEdit:S}=ke(),T=X(()=>Oe(i.task.created_at));return(k,f)=>(y(),O(Y,null,[d("div",{class:H(["card animate__animated animate__zoomIn",{"has-background-success-light":e.task.is_completed,"has-background-warning-light":!e.task.is_completed}])},[d("header",Pe,[d("p",Re,P(e.task.title),1)]),d("div",je,[d("div",be,[d("div",null,P(e.task.description),1),d("span",Fe,[Me,d("span",null,P(c(T)),1)])])]),d("footer",we,[d("span",De,[e.task.is_completed?(y(),O("span",{key:0,onClick:f[0]||(f[0]=C=>c(r)(e.task.id)),class:"icon has-text-success"},Le)):(y(),O("span",{key:1,onClick:f[1]||(f[1]=C=>c(h)(e.task.id)),class:"icon has-text-success"},ze))]),d("span",qe,[d("span",{onClick:f[2]||(f[2]=C=>_.value=!0),class:"icon has-text-primary"},Ve)]),d("span",$e,[d("span",{onClick:f[3]||(f[3]=(...C)=>c(m)&&c(m)(...C)),class:"icon has-text-danger"},He)])])],2),c(_)?(y(),R(c(t),{key:0,onClose:f[4]||(f[4]=C=>_.value=!1)},{default:W(()=>[G(c(a),{onSuccess:c(S),onFail:c(p),id:e.task.id,title:e.task.title,description:e.task.description},null,8,["onSuccess","onFail","id","title","description"])]),_:1})):j("",!0),c(I).isOpen?(y(),R(c(s),{key:1,onClose:f[5]||(f[5]=C=>c(I).isOpen=!1),type:c(I).type,message:c(I).message},null,8,["type","message"])):j("",!0),c(u).isOpen?(y(),R(c(n),{key:2,onConfirm:f[6]||(f[6]=C=>c(l)(e.task.id)),onCancel:c(o),title:c(u).title,message:c(u).message},null,8,["onCancel","title","message"])):j("",!0)],64))}},Qe=ie(We,[["__scopeId","data-v-614a3f6b"]]);export{Qe as default};
